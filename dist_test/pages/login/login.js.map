{"version":3,"file":"pages/login/login.js","sources":["webpack:///./src/pages/login/login.vue?3e13","webpack:///login.vue","webpack:///./src/pages/login/login.vue?230c","webpack:///._src_pages_login_login.less","webpack:///._src_pages_login_login.vue","webpack:///./src/pages/login/login.vue?52b5","webpack:///./src/pages/login/login.vue?6a8d"],"sourcesContent":["import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=23b3be22&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"4011929f\"\n  \n)\n\ncomponent.options.__file = \"src/pages/login/login.vue\"\nexport default component.exports","<template>\r\n  <view>\r\n    <view class=\"logintitle\">欢迎登录满满打车</view>\r\n    <view>\r\n      <input\r\n        type=\"number\"\r\n        maxlength=\"11\"\r\n        placeholder=\"请输入用户名\"\r\n        class=\"inputNum\"\r\n        @input=\"getUsernme\"\r\n      />\r\n      <input\r\n        type=\"password\"\r\n        placeholder=\"请输入登录密码\"\r\n        class=\"inputpwd\"\r\n        @input=\"changeLoginColor\"\r\n      />\r\n      <button\r\n        class=\"loginBtn\"\r\n        :style=\"{ backgroundColor: loginColor }\"\r\n        @tap=\"login\"\r\n      >\r\n        登录\r\n      </button>\r\n    </view>\r\n    <view class=\"signText\" @tap=\"toSingin\">点击注册账号 或</view>\r\n    <button class=\"wechatBtn\" @tap=\"loginWechat\">使用微信一键登录</button>\r\n    <view class=\"foot\">\r\n      登录即表示您同意\r\n      <view class=\"footText\">《服务条款》</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n<script>\r\nimport \"./login.less\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport {\r\n  set as setGlobalData,\r\n  get as getGlobalData,\r\n} from \"../../utils/global_data\";\r\nimport { baseUrl } from \"../../utils/baseurl\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      loginColor: \"#ccc\",\r\n      userInfo: null,\r\n      isLogin: false,\r\n      userName: \"\",\r\n      password: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    changeLoginColor(e) {\r\n      this.password = e.target.value;\r\n      if (e.target.value.length != 0) {\r\n        this.loginColor = \"#FB841E\";\r\n      } else {\r\n        this.loginColor = \"#ccc\";\r\n      }\r\n    },\r\n    toSingin() {\r\n      // navigateTo向下一级跳转，可以返回\r\n      Taro.navigateTo({\r\n        url: \"/pages/login/sign/sign\",\r\n      });\r\n    },\r\n    getUsernme(e) {\r\n      this.userName = e.target.value;\r\n    },\r\n    login() {\r\n      console.log(\"乘客请求登录\");\r\n      Taro.request({\r\n        url: baseUrl.passenger + \"travel/passenger/login\",\r\n        method: \"POST\",\r\n        data: {\r\n          account: this.userName,\r\n          password: this.password,\r\n        },\r\n      })\r\n        .then((res) => {\r\n          if (res.data.success) {\r\n            const token = res.data.data;\r\n            setGlobalData(\"token\", token);\r\n            setGlobalData(\"isLogin\", true);\r\n            Taro.setStorageSync(\"token\", token);\r\n            Taro.redirectTo({ url: \"/pages/taxi/taxi\" });\r\n          } else {\r\n            Taro.showToast({\r\n              title: \"账户名或密码错误\",\r\n              icon: \"none\",\r\n              duration: 2000,\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          setGlobalData(\"isLogin\", false);\r\n        });\r\n    },\r\n    loginWechat() {\r\n      Taro.getUserProfile({\r\n        desc: \"用于完善用户资料\", // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写\r\n        success: (res) => {\r\n          console.log(\"res\", res);\r\n          if (res.data.success) {\r\n            setGlobalData(\"userInfo\", res.userInfo);\r\n            setGlobalData(\"isLogin\", true);\r\n            this.userInfo = getGlobalData(\"userInfo\");\r\n            this.isLogin = getGlobalData(\"isLogin\");\r\n            //redirectTo同级跳转，无法返回上一步\r\n            Taro.redirectTo({ url: \"/pages/taxi/taxi\" });\r\n          } else {\r\n            Taro.showToast({\r\n              title: \"账户名或密码错误\",\r\n              icon: \"none\",\r\n              duration: 2000,\r\n            });\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.log(\"获取用户信息失败\");\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"view\", [\n    _c(\"view\", { staticClass: \"logintitle\" }, [_vm._v(\"欢迎登录满满打车\")]),\n    _c(\"view\", [\n      _c(\"input\", {\n        staticClass: \"inputNum\",\n        attrs: { type: \"number\", maxlength: \"11\", placeholder: \"请输入用户名\" },\n        on: { input: _vm.getUsernme },\n      }),\n      _c(\"input\", {\n        staticClass: \"inputpwd\",\n        attrs: { type: \"password\", placeholder: \"请输入登录密码\" },\n        on: { input: _vm.changeLoginColor },\n      }),\n      _c(\n        \"button\",\n        {\n          staticClass: \"loginBtn\",\n          style: { backgroundColor: _vm.loginColor },\n          on: { tap: _vm.login },\n        },\n        [_vm._v(\" 登录 \")]\n      ),\n    ]),\n    _c(\"view\", { staticClass: \"signText\", on: { tap: _vm.toSingin } }, [\n      _vm._v(\"点击注册账号 或\"),\n    ]),\n    _c(\"button\", { staticClass: \"wechatBtn\", on: { tap: _vm.loginWechat } }, [\n      _vm._v(\"使用微信一键登录\"),\n    ]),\n    _c(\"view\", { staticClass: \"foot\" }, [\n      _vm._v(\" 登录即表示您同意 \"),\n      _c(\"view\", { staticClass: \"footText\" }, [_vm._v(\"《服务条款》\")]),\n    ]),\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./login.vue\"\nvar config = {\"navigationBarTitleText\":\"满满打车\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/login/login', {root:{cn:[]}}, config || {}))\n\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=template&id=23b3be22&\""],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACeA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAHA;AASA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AArBA;AAuBA;AAxEA;AAVA;;;;;;;;;;;;;ACzCA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzCA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACNA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}